!function(t){"use strict";function e(t,n){function o(t,e){return function(){return t.apply(e,arguments)}}var r;n=n||{};this.trackingClick=!1;this.trackingClickStart=0;this.targetElement=null;this.touchStartX=0;this.touchStartY=0;this.lastTouchIdentifier=0;this.touchBoundary=n.touchBoundary||10;this.layer=t;this.tapDelay=n.tapDelay||200;if(!e.notNeeded(t)){for(var c=["onMouse","onClick","onTouchStart","onTouchMove","onTouchEnd","onTouchCancel"],a=this,s=0,u=c.length;u>s;s++)a[c[s]]=o(a[c[s]],a);if(i){t.addEventListener("mouseover",this.onMouse,!0);t.addEventListener("mousedown",this.onMouse,!0);t.addEventListener("mouseup",this.onMouse,!0)}t.addEventListener("click",this.onClick,!0);t.addEventListener("touchstart",this.onTouchStart,!1);t.addEventListener("touchmove",this.onTouchMove,!1);t.addEventListener("touchend",this.onTouchEnd,!1);t.addEventListener("touchcancel",this.onTouchCancel,!1);if(!Event.prototype.stopImmediatePropagation){t.removeEventListener=function(e,n,i){var o=Node.prototype.removeEventListener;"click"===e?o.call(t,e,n.hijacked||n,i):o.call(t,e,n,i)};t.addEventListener=function(e,n,i){var o=Node.prototype.addEventListener;"click"===e?o.call(t,e,n.hijacked||(n.hijacked=function(t){t.propagationStopped||n(t)}),i):o.call(t,e,n,i)}}if("function"==typeof t.onclick){r=t.onclick;t.addEventListener("click",function(t){r(t)},!1);t.onclick=null}}}var n=navigator.userAgent,i=n.indexOf("Android")>0,o=/iP(ad|hone|od)/.test(n),r=o&&/OS 4_\d(_\d)?/.test(n),c=o&&/OS ([6-9]|\d{2})_\d/.test(n),a=n.indexOf("BB10")>0;e.prototype.needsClick=function(t){switch(t.nodeName.toLowerCase()){case"button":case"select":case"textarea":if(t.disabled)return!0;break;case"input":if(o&&"file"===t.type||t.disabled)return!0;break;case"label":case"video":return!0}return/\bneedsclick\b/.test(t.className)};e.prototype.needsFocus=function(t){switch(t.nodeName.toLowerCase()){case"textarea":return!0;case"select":return!i;case"input":switch(t.type){case"button":case"checkbox":case"file":case"image":case"radio":case"submit":return!1}return!t.disabled&&!t.readOnly;default:return/\bneedsfocus\b/.test(t.className)}};e.prototype.sendClick=function(e,n){var i,o;document.activeElement&&document.activeElement!==e&&document.activeElement.blur();o=n.changedTouches[0];i=document.createEvent("MouseEvents");i.initMouseEvent(this.determineEventType(e),!0,!0,t,1,o.screenX,o.screenY,o.clientX,o.clientY,!1,!1,!1,!1,0,null);i.forwardedTouchEvent=!0;e.dispatchEvent(i)};e.prototype.determineEventType=function(t){return i&&"select"===t.tagName.toLowerCase()?"mousedown":"click"};e.prototype.focus=function(t){var e;if(o&&t.setSelectionRange&&0!==t.type.indexOf("date")&&"time"!==t.type){e=t.value.length;t.setSelectionRange(e,e)}else t.focus()};e.prototype.updateScrollParent=function(t){var e,n;e=t.fastClickScrollParent;if(!e||!e.contains(t)){n=t;do{if(n.scrollHeight>n.offsetHeight){e=n;t.fastClickScrollParent=n;break}n=n.parentElement}while(n)}e&&(e.fastClickLastScrollTop=e.scrollTop)};e.prototype.getTargetElementFromEventTarget=function(t){return t.nodeType===Node.TEXT_NODE?t.parentNode:t};e.prototype.onTouchStart=function(e){var n,i,c;if(e.targetTouches.length>1)return!0;n=this.getTargetElementFromEventTarget(e.target);i=e.targetTouches[0];if(o){c=t.getSelection();if(c.rangeCount&&!c.isCollapsed)return!0;if(!r){if(i.identifier&&i.identifier===this.lastTouchIdentifier){e.preventDefault();return!1}this.lastTouchIdentifier=i.identifier;this.updateScrollParent(n)}}this.trackingClick=!0;this.trackingClickStart=e.timeStamp;this.targetElement=n;this.touchStartX=i.pageX;this.touchStartY=i.pageY;e.timeStamp-this.lastClickTime<this.tapDelay&&e.preventDefault();return!0};e.prototype.touchHasMoved=function(t){var e=t.changedTouches[0],n=this.touchBoundary;return Math.abs(e.pageX-this.touchStartX)>n||Math.abs(e.pageY-this.touchStartY)>n?!0:!1};e.prototype.onTouchMove=function(t){if(!this.trackingClick)return!0;if(this.targetElement!==this.getTargetElementFromEventTarget(t.target)||this.touchHasMoved(t)){this.trackingClick=!1;this.targetElement=null}return!0};e.prototype.findControl=function(t){return void 0!==t.control?t.control:t.htmlFor?document.getElementById(t.htmlFor):t.querySelector("button, input:not([type=hidden]), keygen, meter, output, progress, select, textarea")};e.prototype.onTouchEnd=function(e){var n,a,s,u,l,h=this.targetElement;if(!this.trackingClick)return!0;if(e.timeStamp-this.lastClickTime<this.tapDelay){this.cancelNextClick=!0;return!0}this.cancelNextClick=!1;this.lastClickTime=e.timeStamp;a=this.trackingClickStart;this.trackingClick=!1;this.trackingClickStart=0;if(c){l=e.changedTouches[0];h=document.elementFromPoint(l.pageX-t.pageXOffset,l.pageY-t.pageYOffset)||h;h.fastClickScrollParent=this.targetElement.fastClickScrollParent}s=h.tagName.toLowerCase();if("label"===s){n=this.findControl(h);if(n){this.focus(h);if(i)return!1;h=n}}else if(this.needsFocus(h)){if(e.timeStamp-a>100||o&&t.top!==t&&"input"===s){this.targetElement=null;return!1}this.focus(h);this.sendClick(h,e);if(!o||"select"!==s){this.targetElement=null;e.preventDefault()}return!1}if(o&&!r){u=h.fastClickScrollParent;if(u&&u.fastClickLastScrollTop!==u.scrollTop)return!0}if(!this.needsClick(h)){e.preventDefault();this.sendClick(h,e)}return!1};e.prototype.onTouchCancel=function(){this.trackingClick=!1;this.targetElement=null};e.prototype.onMouse=function(t){if(!this.targetElement)return!0;if(t.forwardedTouchEvent)return!0;if(!t.cancelable)return!0;if(!this.needsClick(this.targetElement)||this.cancelNextClick){t.stopImmediatePropagation?t.stopImmediatePropagation():t.propagationStopped=!0;t.stopPropagation();t.preventDefault();return!1}return!0};e.prototype.onClick=function(t){var e;if(this.trackingClick){this.targetElement=null;this.trackingClick=!1;return!0}if("submit"===t.target.type&&0===t.detail)return!0;e=this.onMouse(t);e||(this.targetElement=null);return e};e.prototype.destroy=function(){var t=this.layer;if(i){t.removeEventListener("mouseover",this.onMouse,!0);t.removeEventListener("mousedown",this.onMouse,!0);t.removeEventListener("mouseup",this.onMouse,!0)}t.removeEventListener("click",this.onClick,!0);t.removeEventListener("touchstart",this.onTouchStart,!1);t.removeEventListener("touchmove",this.onTouchMove,!1);t.removeEventListener("touchend",this.onTouchEnd,!1);t.removeEventListener("touchcancel",this.onTouchCancel,!1)};e.notNeeded=function(e){var o,r,c;if("undefined"==typeof t.ontouchstart)return!0;r=+(/Chrome\/([0-9]+)/.exec(n)||[,0])[1];if(r){if(!i)return!0;o=document.querySelector("meta[name=viewport]");if(o){if(-1!==o.content.indexOf("user-scalable=no"))return!0;if(r>31&&document.documentElement.scrollWidth<=t.outerWidth)return!0}}if(a){c=n.match(/Version\/([0-9]*)\.([0-9]*)/);if(c[1]>=10&&c[2]>=3){o=document.querySelector("meta[name=viewport]");if(o){if(-1!==o.content.indexOf("user-scalable=no"))return!0;if(document.documentElement.scrollWidth<=t.outerWidth)return!0}}}return"none"===e.style.msTouchAction?!0:!1};e.attach=function(t,n){return new e(t,n)};"function"==typeof define&&define("fastclick",[],function(){return e});t.FastClick=e}(this);
